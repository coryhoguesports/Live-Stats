<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>CoryHogueSports Live Game Stats</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { color-scheme: light; }
    body{ margin:0; background:#fff; font:500 16px/1.35 system-ui, Arial; color:#000; }
    h1{ text-align:center; font-weight:600; margin:14px 0; }
    .wrap{ max-width:1100px; margin:0 auto 18px; padding:0 12px; }
    .grid{ display:grid; grid-template-columns:1fr 1fr; gap:22px; }
    table{ width:100%; border-collapse:collapse; background:#fff; }
    th,td{ border:1px solid #000; padding:6px 8px; vertical-align:top; }
    .center{ text-align:center; }
    .meta{ display:grid; grid-template-columns:1fr auto 1fr; align-items:end; gap:14px; margin:6px 0 10px; }
    .meta .box{ text-align:center; }
    .note{ text-align:center; font-weight:600; margin:10px 0 16px; }
    /* tweak for small screens */
    @media (max-width:900px){ .grid{ grid-template-columns:1fr; } }
  </style>
</head>
<body>
  <h1>üèà CoryHogueSports Live Game Stats</h1>
  <div class="wrap">
    <div class="meta">
      <div class="box" id="leftTeam"  ></div>
      <div class="box" id="clockRow"  ></div>
      <div class="box" id="rightTeam" ></div>
    </div>
    <div class="note" id="headline"></div>

    <div class="grid">
      <div>
        <table id="leftTeamStats"></table>
        <br/>
        <table id="leftIndivRush"></table>
        <br/>
        <table id="leftIndivPass"></table>
      </div>
      <div>
        <table id="rightTeamStats"></table>
        <br/>
        <table id="rightIndivRush"></table>
        <br/>
        <table id="rightIndivPass"></table>
      </div>
    </div>
  </div>

  <script>
    const WEBAPP_JSON = "https://script.google.com/macros/s/AKfycbyml0Pv99NXqzMBSUOp5CF3MOiDnzu5U7oJEbG9_2fOgiqD2IiX5-HUOp11TiPsl2EtGA/exec"; // <-- replace me

    // Helper makes a simple table from a 2D array
    function drawTable(el, rows){
      el.innerHTML = rows.map(r => "<tr>"+ r.map(c => `<td>${(c ?? "").toString().replace(/</g,"&lt;")}</td>`).join("") +"</tr>").join("");
      // first row as header look
      if (rows.length) {
        const first = el.querySelector("tr");
        if (first) first.outerHTML = first.outerHTML.replaceAll("<td>","<th>").replaceAll("</td>","</th>");
      }
    }

    async function load() {
      try {
        const url = WEBAPP_JSON + "?v=" + Date.now(); // cache-buster
        const res = await fetch(url, { cache: "no-store" });
        const { data } = await res.json(); // data is the full Stats sheet

        // ------ Map your known cells/ranges here ------
        // Below are example picks based on your screenshots. Adjust the row/col indexes to your sheet.
        // data[r][c] is 0-based: A1 => data[0][0]
        // Header strip
        document.getElementById("leftTeam").textContent  = (data[0]?.[0] ?? "");
        document.getElementById("clockRow").innerHTML    = `Time<br><span style="font-weight:700">${data[1]?.[2] ?? ""}</span>`;
        document.getElementById("rightTeam").textContent = (data[0]?.[6] ?? "");

        // Headline / penalty line
        document.getElementById("headline").textContent = (data[6]?.[0] ?? "");

        // Team stat boxes (example: rows 8..16, two columns of label/value)
        drawTable(document.getElementById("leftTeamStats"),
          data.slice(8,17).map(r => [r[0], r[1]]));

        drawTable(document.getElementById("rightTeamStats"),
          data.slice(8,17).map(r => [r[6], r[7]]));

        // Individual rushing (example: rows 19..23)
        drawTable(document.getElementById("leftIndivRush"),
          [ ["Individual Rushing","Att","Yds","TD"], ...data.slice(19,23).map(r => [r[0], r[1], r[2], r[3]]) ]);

        drawTable(document.getElementById("rightIndivRush"),
          [ ["Individual Rushing","Att","Yds","TD"], ...data.slice(19,24).map(r => [r[6], r[7], r[8], r[9]]) ]);

        // Individual passing (example: rows 26..27)
        drawTable(document.getElementById("leftIndivPass"),
          [ ["Individual Passing","Comp","Att","Int","Yds","TD"], ...data.slice(26,27).map(r => [r[0], r[1], r[2], r[3], r[4], r[5]]) ]);

        drawTable(document.getElementById("rightIndivPass"),
          [ ["Individual Passing","Comp","Att","Int","Yds","TD"], ...data.slice(26,28).map(r => [r[6], r[7], r[8], r[9], r[10], r[11]]) ]);
        // ------ end mapping ------

      } catch (e) {
        console.error(e);
      }
    }

    load();
    setInterval(load, 5000); // refresh every 5s
  </script>
</body>
</html>
